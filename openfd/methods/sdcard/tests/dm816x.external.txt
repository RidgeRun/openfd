echo  SDCard Installer Script Generated by OpenFD
echo  Target Platform: DM816x Board
echo
askenv dummy "  Press any key to continue..." 1
echo
echo
echo  ====== Installing uboot-min ======
echo
fatload mmc 0 ${loadaddr} u-boot.noxip.bin
nand erase 0x0 0x40000
nandecc hw 2
nand write ${loadaddr} 0x0 0x40000
nandecc sw
setenv ipl_md5sum b91d5caed0f5ac3de78fc764545ca9f7
setenv ipl_offset 0x0
setenv ipl_size 0x40000
setenv ipl_partitionsize 0x40000
echo
echo  ====== Installing uboot ======
echo
fatload mmc 0 ${loadaddr} bootloader.nandbin
nand erase 0x40000 0x40000
nand write ${loadaddr} 0x40000 0x40000
echo
echo  ====== Installing kernel ======
echo
fatload mmc 0 ${loadaddr} kernel.uImage
nand erase 0x280000 0x440000
nand write ${loadaddr} 0x280000 0x2a0000
setenv kernel_md5sum 43388ab7805b2daed14969f908f04dd7
setenv kernel_offset 0x280000
setenv kernel_size 0x2a0000
setenv kernel_partitionsize 0x440000
echo
echo  ====== Installing rootfs ======
echo
fatload mmc 0 ${loadaddr} fsimage.uImage
nand erase 0x6c0000 0x38c0000
nand write ${loadaddr} 0x6c0000 0x34c0000
setenv fs_md5sum 320fedec05fee00fe3052203da3cd82a
setenv fs_offset 0x6c0000
setenv fs_size 0x34c0000
setenv fs_partitionsize 0x38c0000
echo
echo  ====== Installing Environment ======
echo
setenv bootargs console=ttyO2,115200n8 notifyk.vpssm3_sva=0xBF900000 rootfstype=jffs2 root=mtd:ROOTFS mem=364M@0x80000000 mem=320M@0x9FC00000 vmalloc=512M vram=81M mtdparts=omap2-nand.0:2560k(UBOOT),4352k(KERNEL),56576k(ROOTFS)
setenv autostart yes
setenv bootdelay 2
setenv bootcmd nboot 0x82000000 0 ${kernel_offset}
saveenv
echo
echo  ====== Installation Complete! ======
echo
echo "You may restart your board by"
echo "  - turning off power,"
echo "  - removing the SD card,"
echo "  - setting hardware to boot from NAND, and"
echo "  - powering on the board."
echo
echo
