echo  SDCard Installer Script Generated by OpenFD
echo  Target Platform: ${mach_desc}
echo
askenv dummy "  Press any key to continue..." 1
echo
echo

echo  ====== Installing ${ipl_name}...
echo
fatload mmc 0 ${loadaddr} ${ipl_image}
${ipl_erase_cmd} ${ipl_erase_offset} ${ipl_erase_size}
${ipl_pre_write_cmd}
${ipl_write_cmd} ${loadaddr} ${ipl_write_offset} ${ipl_write_size}
${ipl_post_write_cmd}
echo
echo  ====== Installing U-boot...
echo
fatload mmc 0 ${loadaddr} @UBOOTIMAGE@
@FLASH_ERASE_CMD@ @UBOOT_OFFSET@ @UBOOT_PSIZE@
@FLASH_WRITE_IPL_CMD@ ${loadaddr} @UBOOT_OFFSET@ @UBOOT_PSIZE@
echo
echo  ====== Installing Kernel...
echo
fatload mmc 0 ${loadaddr} kernel.uImage
@FLASH_ERASE_CMD@ @KERNEL_OFFSET@ @KERNEL_PSIZE@
@FLASH_WRITE_CMD@ ${loadaddr} @KERNEL_OFFSET@ @KERNEL_SIZE@
setenv kerneloffset @KERNEL_OFFSET@
setenv ksize @KERNEL_SIZE@
setenv kernelmd5sum @KERNEL_CHECKSUM@
echo
echo  ====== Installing File System...
echo
fatload mmc 0 ${loadaddr} fsimage.uImage
@FLASH_ERASE_CMD@ @FS_OFFSET@ @FS_PSIZE@
@FLASH_WRITE_CMD@ ${loadaddr} @FS_OFFSET@ ${filesize}
setenv fssize @FS_SIZE@
setenv fspartitionsize @FS_PSIZE@
setenv fsoffset @FS_OFFSET@
setenv fsmd5sum @FS_CHECKSUM@
echo
echo  ====== Installing Boot Settings...
echo
setenv bootargs @BOOTARGS@
setenv autostart yes
setenv bootdelay 2
setenv bootcmd @BOOTCMD@
saveenv
echo
echo  ======= Installation Complete!
echo
echo "You may restart your board by"
echo "  - turning off power,"
echo "  - removing the SD card,"
echo "  - setting hardware to boot from NAND, and"
echo "  - powering on the board."
echo
echo